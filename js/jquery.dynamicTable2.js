!function(f){f.fn.extend({dynamicTable:function(c){var s={},l={};function d(e,i,a,t){void 0!==l[a]&&4!=l[a].readyState&&l[a].abort(),f("#DTloader_"+a).html('<img src="'+i.img+'" />');var o="";null!=c.filters?f.each(c.filters,function(){var e,a,t;key=f(this).attr("name"),val=f(this).val(),o+="&"+key+"="+val,e=c.objId,a=key,t=val,locStor=Storages.localStorage.get("dynamicTable"),locStor.items=locStor.items.filter(function(t){return(t.key!==a||t.cls!==e)&&t.created>new Date-2592e6}),t&&locStor.items.push({cls:e,key:a,val:t,created:+new Date}),Storages.localStorage.set("dynamicTable",locStor)}):o+="&q="+f("#DTsearch_"+a).val(),l[a]=f.get(i.url+"&from="+(f(e).find("tbody tr").length-1)+"&limit="+t+o,function(t){f.each(t,function(t,a){rowstyle=isNaN(a.rowstyle)?rowstyle=" "+a.rowstyle+" ":"",chtml=$("<tr>").attr("style",rowstyle),f.each(i.cells,function(t,e){chtml.append($("<td>").html(a[e]).data("col",e))}),"function"==typeof c.onRow&&(chtml=c.onRow(chtml,a)),f(e).find("tbody tr:last").after(chtml)}),"function"==typeof c.onFinish&&c.onFinish(f(e)),i.sum&&function(t){{var a,e,i,o,l;c.sum&&(f(t).find("tfoot").remove(),a=[],f.each(f(t).find("thead tr th"),function(t,e){f(e).hasClass("nosum")?a[t]=!0:a[t]=!1}),e=f(t).find("tbody tr"),i=[],f.each(e,function(t,e){var a=f(e).find("td");f.each(a,function(t,e){skaicius=f(e).html(),skaicius=skaicius.match(/[+-]?\d+(\.\d+)?/),skaicius=skaicius&&parseFloat(skaicius[0]),isNaN(skaicius)&&(skaicius=0),accumulated=parseFloat(i[t]),isNaN(accumulated)&&(accumulated=0),i[t]=accumulated+skaicius})}),o=[],f.each(i,function(t,e){a[t]?o[t]="<th></th>":o[t]="<th>"+(0<e?e.toFixed(2):"-")+"</th>"}),l="<tfoot><tr>"+o.join("")+"</tr></tfoot>",f(t).find("tbody").after(l))}}(e),f("#DTloader_"+a).html("")},"json")}var c=f.extend({img:"/images/loading.gif",url:"/",sum:!0,more:"rodyti daugiau",all:"rodyti visus",limit:25,buttons:!0,onRow:"",onFinish:"",cells:[]},c),u=Math.round(1e5*Math.random());return Storages.localStorage.isSet("dynamicTable")||Storages.localStorage.set("dynamicTable",{items:[]}),this.each(function(){var a=this;c.objId=f(this).attr("id"),null==c.objId&&(c.objId="tbl_"+u,f(this).attr("id",c.objId));var t=f("#"+c.objId+"-filters");null!=t.html()||(t=f('<div style="text-align:right" id="'+c.objId+'-filters"><input type="text" size="40" class="'+c.objId+'-filter" name="q" /><input type="button" class="reset DTbutton" value="X" /></div>'),f(a).before(t));var e=t.find("."+c.objId+"-filter"),i=t,o=c.objId;c.filters=e,c.qstr="",f.each(e,function(){var e=f(this);locStor=Storages.localStorage.get("dynamicTable"),locStor.items=locStor.items.filter(function(t){return t.key===e.attr("name")&&t.cls===c.objId}),cval=void 0!==locStor.items[0]?locStor.items[0].val:"",""!=cval&&e.val(cval),e.on("keyup change",function(t){("text"!=e.attr("type")||"change"!=t.type&&"keyup"!=t.type)&&"change"!=t.type||r(function(){var t=void 0===s[o]?null:s[o],e=i.find("."+o+"-filter").serialize();t!=e&&(s[o]=e,f(a).find("tbody tr:gt(0)").remove(),d(a,l,u,l.limit))},700)})}),t.find(".reset").click(function(){void 0!==s[o]&&delete s[o],f.each(e,function(){f(this).val("").trigger("change")})});var l=c;l.buttons&&(f(a).after('<a id="DTmore_'+u+'" class="DTbutton more" href="javascript:void(0)">'+l.more+'</a> <a id="DTall_'+u+'" class="DTbutton all" href="javascript:void(0)">'+l.all+'</a> <span id="DTloader_'+u+'"></span>'),f("#DTmore_"+u).click(function(){d(a,l,u,l.limit)}),f("#DTall_"+u).click(function(){d(a,l,u,99999)})),d(a,l,u,l.limit);var n,r=(n=0,function(t,e){clearTimeout(n),n=setTimeout(t,e)})})}})}(jQuery);